{% include base_path %}

{% assign display_year = post.pub_year %}
{% if display_year == nil or display_year == "" %}
  {% if post.date %}
    {% assign display_year = post.date | date: "%Y" %}
  {% else %}
    {% assign display_year = "Year N/A" %}
  {% endif %}
{% endif %}

{% assign highlight_label = post.highlight %}
{% if highlight_label == nil or highlight_label == "" %}
  {% if post.venue contains 'Best Paper' %}
    {% assign highlight_label = 'Best Paper' %}
  {% elsif post.venue contains 'Spotlight' %}
    {% assign highlight_label = 'Spotlight' %}
  {% elsif post.venue contains 'Oral' %}
    {% assign highlight_label = 'Oral' %}
  {% elsif post.venue contains 'Highlight' %}
    {% assign highlight_label = 'Highlight' %}
  {% endif %}
{% endif %}

{% assign display_venue = post.venue %}
{% if display_venue == nil or display_venue == "" %}
  {% assign display_venue = "Venue N/A" %}
{% else %}
  {% assign display_venue = display_venue | replace: "<font color=red><b>(Best Paper Award)</b></font>", "" | replace: "(Best Paper Award)", "" | replace: "(Best Paper)", "" | strip %}
{% endif %}

<div class="pub-card">
  <h3 class="pub-card__title">{{ post.title }}</h3>

  <p class="pub-card__meta">
    <span class="pub-card__venue">{{ display_venue }}</span>
    <span class="pub-card__dot">â€¢</span>
    <span class="pub-card__year">{{ display_year }}</span>
  </p>

  {% if post.author %}
    <p class="pub-card__authors">{{ post.author }}</p>
  {% endif %}

  {% assign has_chips = false %}
  {% if post.topic or post.author_role or highlight_label %}
    {% assign has_chips = true %}
  {% endif %}

  {% if has_chips %}
  <div class="pub-card__chips">
    {% if post.topic %}
      <span class="pub-chip pub-chip--topic">{{ post.topic }}</span>
    {% endif %}

    {% if post.author_role %}
      <span class="pub-chip pub-chip--role">{{ post.author_role }}</span>
    {% endif %}

    {% if highlight_label %}
      {% if highlight_label == 'Best Paper' %}
        <span class="pub-chip pub-chip--best-paper">Best Paper</span>
      {% else %}
        <span class="pub-chip pub-chip--highlight">{{ highlight_label }}</span>
      {% endif %}
    {% endif %}
  </div>
  {% endif %}

  {% assign has_links = false %}
  {% if post.pdf or post.code or post.project or post.review %}
    {% assign has_links = true %}
  {% endif %}

  {% if has_links %}
  <p class="pub-card__links">
    {% if post.pdf %}<a class="pub-link" href="{{ post.pdf }}" target="_blank" rel="noopener">Paper</a>{% endif %}
    {% if post.code %}<a class="pub-link" href="{{ post.code }}" target="_blank" rel="noopener">Code</a>{% endif %}
    {% if post.project %}<a class="pub-link" href="{{ post.project }}" target="_blank" rel="noopener">Project</a>{% endif %}
    {% if post.review %}<a class="pub-link" href="{{ post.review }}" target="_blank" rel="noopener">Review</a>{% endif %}
  </p>
  {% endif %}
</div>
